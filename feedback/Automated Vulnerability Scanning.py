import subprocess

def run_vulnerability_scan(target_ip):
    try:
        # Start OpenVAS scanner (example command, adjust for your setup)
        subprocess.run(["openvas-start"], check=True)
        # Run scan
        result = subprocess.run(
            ["omp", "-u", "admin", "-w", "admin", "-G", "-i", "<scan-id>", "-t", target_ip],
            capture_output=True, text=True
        )
        return f"Scan results:\n{result.stdout}"
    except subprocess.CalledProcessError as e:
        return f"Error running vulnerability scan: {e}"

# Example usage
print(run_vulnerability_scan("192.168.1.1"))
